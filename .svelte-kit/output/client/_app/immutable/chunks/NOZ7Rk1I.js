var A=Object.defineProperty;var M=s=>{throw TypeError(s)};var B=(s,e,t)=>e in s?A(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var w=(s,e,t)=>B(s,typeof e!="symbol"?e+"":e,t),D=(s,e,t)=>e.has(s)||M("Cannot "+t);var i=(s,e,t)=>(D(s,e,"read from private field"),t?t.call(s):e.get(s)),d=(s,e,t)=>e.has(s)?M("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),F=(s,e,t,r)=>(D(s,e,"write to private field"),r?r.call(s,t):e.set(s,t),t);import{I as N,J as I,K as k,L as O,d as S,M as U,h as T,k as C,N as E,O as G,P as x,Q as J,R as K,T as L,F as P,U as Q,G as R,V}from"./DzQrzwyc.js";var c,h,f,l,p,_,m;class q{constructor(e,t=!0){w(this,"anchor");d(this,c,new Map);d(this,h,new Map);d(this,f,new Map);d(this,l,new Set);d(this,p,!0);d(this,_,()=>{var e=N;if(i(this,c).has(e)){var t=i(this,c).get(e),r=i(this,h).get(t);if(r)I(r),i(this,l).delete(t);else{var n=i(this,f).get(t);n&&(i(this,h).set(t,n.effect),i(this,f).delete(t),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),r=n.effect)}for(const[a,o]of i(this,c)){if(i(this,c).delete(a),a===e)break;const u=i(this,f).get(o);u&&(k(u.effect),i(this,f).delete(o))}for(const[a,o]of i(this,h)){if(a===t||i(this,l).has(a))continue;const u=()=>{if(Array.from(i(this,c).values()).includes(a)){var g=document.createDocumentFragment();E(o,g),g.append(S()),i(this,f).set(a,{effect:o,fragment:g})}else k(o);i(this,l).delete(a),i(this,h).delete(a)};i(this,p)||!r?(i(this,l).add(a),O(o,u,!1)):u()}}});d(this,m,e=>{i(this,c).delete(e);const t=Array.from(i(this,c).values());for(const[r,n]of i(this,f))t.includes(r)||(k(n.effect),i(this,f).delete(r))});this.anchor=e,F(this,p,t)}ensure(e,t){var r=N,n=G();if(t&&!i(this,h).has(e)&&!i(this,f).has(e))if(n){var a=document.createDocumentFragment(),o=S();a.append(o),i(this,f).set(e,{effect:U(()=>t(o)),fragment:a})}else i(this,h).set(e,U(()=>t(this.anchor)));if(i(this,c).set(r,e),n){for(const[u,b]of i(this,h))u===e?r.skipped_effects.delete(b):r.skipped_effects.add(b);for(const[u,b]of i(this,f))u===e?r.skipped_effects.delete(b.effect):r.skipped_effects.add(b.effect);r.oncommit(i(this,_)),r.ondiscard(i(this,m))}else T&&(this.anchor=C),i(this,_).call(this)}}c=new WeakMap,h=new WeakMap,f=new WeakMap,l=new WeakMap,p=new WeakMap,_=new WeakMap,m=new WeakMap;let v=!1,y=Symbol();function z(s,e,t){const r=t[e]??(t[e]={store:null,source:J(void 0),unsubscribe:x});if(r.store!==s&&!(y in t))if(r.unsubscribe(),r.store=s??null,s==null)r.source.v=void 0,r.unsubscribe=x;else{var n=!0;r.unsubscribe=K(s,a=>{n?r.source.v=a:R(r.source,a)}),n=!1}return s&&y in t?L(s):P(r.source)}function H(){const s={};function e(){Q(()=>{for(var t in s)s[t].unsubscribe();V(s,y,{enumerable:!1,value:!0})})}return[s,e]}function W(s){var e=v;try{return v=!1,[s(),v]}finally{v=e}}export{q as B,z as a,W as c,H as s};
